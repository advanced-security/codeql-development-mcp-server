# Integration Test: codeql_bqrs_interpret - sarif_format

This integration test validates the `codeql_bqrs_interpret` MCP server tool with SARIF (Static Analysis Results Interchange Format) output.

## Test Description

Tests the functionality of interpreting BQRS files into SARIF format, which is the standard output format for security and code quality findings.

## Test Setup

### Before State

- `monitoring-state.json`: Empty sessions array (initial state)
- `results.bqrs`: Binary query results file to be interpreted

### After State

- `monitoring-state.json`: Contains session tracking information for the `codeql_bqrs_interpret` tool call
- `results.bqrs`: Same BQRS file (input files are not modified)
- `results.sarif`: Expected SARIF output file (Note: This would be generated by the actual tool execution)

## Tool Parameters

```json
{
  "file": "/test/results.bqrs",
  "format": "sarif-latest",
  "output": "/test/results.sarif",
  "t": ["kind=problem", "id=java/sql-injection"],
  "sarif-add-snippets": true
}
```

## Expected Behavior

The tool should:

1. Read the binary BQRS file
2. Interpret it according to the provided metadata (kind=problem, id=java/sql-injection)
3. Generate a SARIF-formatted output file with code snippets included
4. Track the operation in the monitoring state with success status

## Notes

- SARIF format is commonly used for security findings and code quality issues
- The `sarif-add-snippets` option includes code context around each finding
- The `sarif-latest` format uses the most recent supported SARIF version (v2.1.0)
- This test validates SARIF-specific parameters like `sarif-add-snippets`
